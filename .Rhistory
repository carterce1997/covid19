mutate(
SaturationPoint = m + s * log(p / (1 - p))
) %>%
ggplot() +
geom_histogram(aes(x = SaturationPoint), bins = 100) +
geom_vline(aes(xintercept = median(SaturationPoint))) +
ggtitle('Saturation Point Estimate')
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 100) +
geom_vline(aes(xintercept = median(A))) +
scale_x_log10() +
coord_flip() +
ggtitle('Saturation Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 100) +
geom_vline(aes(xintercept = median(A))) +
scale_x_log10() +
coord_flip() +
ggtitle('Saturation Point Estimate')
(curves + total_cases_estimate) / inflection_estimate +
plot_layout(heights = c(2, 1))
(curves + total_cases_estimate) / (inflection_estimate + ggplot())
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 100) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 10e4) +
coord_flip() +
ggtitle('Saturation Point Estimate')
(curves + total_cases_estimate) / (inflection_estimate + ggplot())
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 10e4) +
coord_flip() +
ggtitle('Saturation Point Estimate')
(curves + total_cases_estimate) / (inflection_estimate + ggplot())
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .05) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ylim(0, 20e4) +
ggtitle('Cumulative Cases Prediction')
p = .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 20e4) +
coord_flip() +
ggtitle('Saturation Point Estimate')
(curves + total_cases_estimate) / (inflection_estimate + ggplot())
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 20e4) +
coord_flip() +
ggtitle('Total Cases Estimate')
(curves + total_cases_estimate) / (inflection_estimate + ggplot())
(curves | total_cases_estimate) / (inflection_estimate | ggplot())
(curves | total_cases_estimate) / (inflection_estimate | plot_spacer())
curves + total_cases_estimate + inflection_estimate + plot_spacer() +
plot_layout(ncol = 2, widths = c(2, 1, 2, 1))
curves + total_cases_estimate + inflection_estimate + plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
trace$phi
trace$phi %>% hist()
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 20e4) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/usa_cumulative_cases_model.R', echo=TRUE)
ny_covid_data <-
covid_data %>%
group_by(Date) %>%
summarize(n = sum(n)) %>%
ungroup() %>%
arrange(Date) %>%
mutate(
DaysOut = as.numeric(difftime(Date, Sys.Date(), units = 'days')),
cumu_n = cumsum(n)
)
stan_data <-
list(
n = nrow(ny_covid_data),
t = ny_covid_data$DaysOut,
cumu_y = ny_covid_data$cumu_n
)
fit <-
sampling(cumulative_model, data = stan_data, chains = 1)
trace <-
spread_draws(fit, A, m, s, phi)
predictions <-
merge(
trace,
data.frame(expand.grid(t = seq(-14, 14)))
) %>%
mutate(
mu_pred = A  / (1 + exp(-(t - m) / s))
)
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .05) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ylim(0, 20e4) +
ggtitle('Cumulative Cases Prediction')
p = .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 20e4) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/usa_cumulative_cases_model.R', echo=TRUE)
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
stan_data$cumu_y
stan_data <-
list(
n = nrow(ny_covid_data),
t = ny_covid_data$DaysOut,
cumu_y = ny_covid_data$cumu_n
)
ny_covid_data <-
covid_data %>%
group_by(Date) %>%
summarize(n = sum(n)) %>%
ungroup() %>%
arrange(Date) %>%
mutate(
DaysOut = as.numeric(difftime(Date, Sys.Date(), units = 'days')),
cumu_n = cumsum(n)
) %>%
filter(DaysOut >= -14)
stan_data <-
list(
n = nrow(ny_covid_data),
t = ny_covid_data$DaysOut,
cumu_y = ny_covid_data$cumu_n
)
fit <-
sampling(cumulative_model, data = stan_data, chains = 1)
trace <-
spread_draws(fit, A, m, s, phi)
predictions <-
merge(
trace,
data.frame(expand.grid(t = seq(-14, 14)))
) %>%
mutate(
mu_pred = A  / (1 + exp(-(t - m) / s))
)
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .05) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ylim(0, 20e4) +
ggtitle('Cumulative Cases Prediction')
p = .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 20e4) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .05) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ylim(0, 40e4) +
ggtitle('Cumulative Cases Prediction')
p = .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 40e4) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .05) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ylim(0, 60e4) +
ggtitle('Cumulative Cases Prediction')
p = .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, 60e4) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/usa_cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .01) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ylim(0, 20e4) +
ggtitle('Cumulative Cases Prediction')
curves
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/usa_cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/usa_cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .01) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ggtitle('Cumulative Cases Prediction')
p <- .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
trace <-
spread_draws(fit, A, m, s, phi) %>%
filter(A <= quantile(A, .95))
predictions <-
merge(
trace,
data.frame(expand.grid(t = seq(-14, 14)))
) %>%
mutate(
mu_pred = A  / (1 + exp(-(t - m) / s))
)
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .01) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ggtitle('Cumulative Cases Prediction')
p <- .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .01) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ylim(0, max(trace$A)) +
ggtitle('Cumulative Cases Prediction')
p <- .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
coord_flip() +
ylim(0, max(trace$A)) +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
ylim(0, max(trace$A)) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, max(trace$A)) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
trace <-
spread_draws(fit, A, m, s, phi) %>%
filter(A <= quantile(A, .9))
predictions <-
merge(
trace,
data.frame(expand.grid(t = seq(-14, 14)))
) %>%
mutate(
mu_pred = A  / (1 + exp(-(t - m) / s))
)
curves <-
ggplot() +
geom_line(aes(x = t, y = mu_pred, group = .draw), data = predictions, alpha = .01) +
geom_line(aes(x = DaysOut, y = cumu_n), data = ny_covid_data, stat = 'identity', color = 'red', size = 1) +
xlim(-14, 14) +
ylim(0, max(trace$A)) +
ggtitle('Cumulative Cases Prediction')
p <- .5
inflection_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = m + s * log(p / (1 - p))), bins = 100) +
geom_vline(aes(xintercept = median(m + s * log(p / (1 - p))))) +
xlim(-14, 14) +
ggtitle('Inflection Point Estimate')
total_cases_estimate <-
trace %>%
ggplot() +
geom_histogram(aes(x = A), bins = 50) +
geom_vline(aes(xintercept = median(A))) +
xlim(0, max(trace$A)) +
coord_flip() +
ggtitle('Total Cases Estimate')
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
source('C:/Users/carte/Desktop/covid19/cumulative_cases_model.R', echo=TRUE)
curves +
total_cases_estimate +
inflection_estimate +
plot_spacer() +
plot_layout(ncol = 2, widths = c(3, 1, 3, 1))
